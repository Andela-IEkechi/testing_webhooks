require 'spec_helper'
require 'json'

describe GithubController, :focus => true do

  before :each do
    @project = create(:project)
    @user    = create(:user)
  	@payload = JSON.parse '{ "after": "2d00bdaa3f0d41a3a9bc355eb38f6245e70d79a1", "before": "4144b9ae4565cf74cbe6c1915123debbab1119bc", "commits": [ { "added": [], "author": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "committer": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "distinct": true, "id": "bf73ba69c1f733fff5003527004b8806f899267d", "message": "change \'add an asset\' to \'attach a file\', prompted by user feedback", "modified": [ "app/views/comments/_form_fields.html.erb" ], "removed": [], "timestamp": "2013-01-21T01:19:31-08:00", "url": "https://github.com/Shuntyard/Conductor/commit/bf73ba69c1f733fff5003527004b8806f899267d" }, { "added": [ "app/controllers/users/omniauth_callbacks_controller.rb" ], "author": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "committer": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "distinct": true, "id": "cc83d40093f560031f41d6e5a8f9e5616de29a2e", "message": "Merge branch \'feature/con132\' into develop", "modified": [ "app/models/user.rb", "config/initializers/devise.rb" ], "removed": [ "app/controllers/user/omniauth_callbacks_controller.rb" ], "timestamp": "2013-01-21T03:07:52-08:00", "url": "https://github.com/Shuntyard/Conductor/commit/cc83d40093f560031f41d6e5a8f9e5616de29a2e" }, { "added": [], "author": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "committer": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "distinct": true, "id": "43d9d6eb169f023f079e9fc974fac2f67686d426", "message": "settign env values for staging and prod [#132]", "modified": [ "config/application.rb", "config/environments/production.rb", "config/environments/staging.rb", "config/initializers/devise.rb" ], "removed": [], "timestamp": "2013-01-21T03:30:54-08:00", "url": "https://github.com/Shuntyard/Conductor/commit/43d9d6eb169f023f079e9fc974fac2f67686d426" }, { "added": [ "app/controllers/users/omniauth_callbacks_controller.rb" ], "author": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "committer": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "distinct": true, "id": "2d00bdaa3f0d41a3a9bc355eb38f6245e70d79a1", "message": "Merge branch \'release/2013_01_21-1\'", "modified": [ "app/controllers/tickets_controller.rb", "app/models/user.rb", "app/views/comments/_form_fields.html.erb", "config/application.rb", "config/environments/production.rb", "config/environments/staging.rb", "config/initializers/devise.rb" ], "removed": [ "app/controllers/user/omniauth_callbacks_controller.rb" ], "timestamp": "2013-01-21T03:32:05-08:00", "url": "https://github.com/Shuntyard/Conductor/commit/2d00bdaa3f0d41a3a9bc355eb38f6245e70d79a1" } ], "compare": "https://github.com/Shuntyard/Conductor/compare/4144b9ae4565...2d00bdaa3f0d", "created": false, "deleted": false, "forced": false, "head_commit": { "added": [ "app/controllers/users/omniauth_callbacks_controller.rb" ], "author": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "committer": { "email": "jeanlrx@gmail.com", "name": "elarex", "username": "elarex" }, "distinct": true, "id": "2d00bdaa3f0d41a3a9bc355eb38f6245e70d79a1", "message": "Merge branch \'release/2013_01_21-1\'", "modified": [ "app/controllers/tickets_controller.rb", "app/models/user.rb", "app/views/comments/_form_fields.html.erb", "config/application.rb", "config/environments/production.rb", "config/environments/staging.rb", "config/initializers/devise.rb" ], "removed": [ "app/controllers/user/omniauth_callbacks_controller.rb" ], "timestamp": "2013-01-21T03:32:05-08:00", "url": "https://github.com/Shuntyard/Conductor/commit/2d00bdaa3f0d41a3a9bc355eb38f6245e70d79a1" }, "hook_callpath": "new", "pusher": { "name": "none" }, "ref": "refs/heads/master", "repository": { "created_at": "2012-07-24T01:07:17-07:00", "description": "Ticketing system", "fork": false, "forks": 0, "has_downloads": true, "has_issues": true, "has_wiki": true, "id": 5162837, "language": "Ruby", "name": "Conductor", "open_issues": 0, "organization": "Shuntyard", "owner": { "email": null, "name": "Shuntyard" }, "private": true, "pushed_at": "2013-01-21T04:44:27-08:00", "size": 2996, "stargazers": 1, "url": "https://github.com/Shuntyard/Conductor", "watchers": 1 } }'
  end

  it 'Does something' do
    post :commit, :project_id => @project.id, :payload => @payload #'/github/commit/1'
  end

end
